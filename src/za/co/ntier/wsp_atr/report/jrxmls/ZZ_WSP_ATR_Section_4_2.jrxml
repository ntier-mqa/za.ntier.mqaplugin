<?xml version="1.0" encoding="UTF-8"?>
<!-- JasperReports 6.21 - Section 4.2 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
	name="ZZ_WSP_ATR_Section_4_2"
	pageWidth="842"
	pageHeight="595"
	orientation="Landscape"
	columnWidth="802"
	leftMargin="20"
	rightMargin="20"
	topMargin="20"
	bottomMargin="20"
	uuid="6b3d3b5a-0e4d-4b53-8e5d-0b4e3d35a222">

	<!-- =========================
	     Styles (declare near top)
	     ========================= -->
	<style name="sTitle" fontName="SansSerif" fontSize="11" isBold="true"/>
	<style name="sSubTitle" fontName="SansSerif" fontSize="9" isBold="false"/>
	<style name="sHdr" fontName="SansSerif" fontSize="8" isBold="true" hAlign="Center" vAlign="Middle"
		   backcolor="#BFBFBF" mode="Opaque"/>
	<style name="sHdr2" fontName="SansSerif" fontSize="8" isBold="true" hAlign="Center" vAlign="Middle"
		   backcolor="#D9D9D9" mode="Opaque"/>
	<style name="sCell" fontName="SansSerif" fontSize="8" isBold="false" hAlign="Center" vAlign="Middle"/>
	<style name="sCellLeft" fontName="SansSerif" fontSize="8" isBold="false" hAlign="Left" vAlign="Middle"/>
	<style name="sTotalLbl" fontName="SansSerif" fontSize="8" isBold="true" hAlign="Left" vAlign="Middle"
		   backcolor="#EEEEEE" mode="Opaque"/>
	<style name="sTotal" fontName="SansSerif" fontSize="8" isBold="true" hAlign="Center" vAlign="Middle"
		   backcolor="#EEEEEE" mode="Opaque"/>

	<!-- =========================
	     Parameter
	     ========================= -->
	<parameter name="ZZ_WSP_ATR_Report_ID" class="java.lang.Integer"/>

	<!-- =========================
	     Query (output table + ref names)
	     ========================= -->
	<queryString>
		<![CDATA[
SELECT
  qt.Name AS qualification_type_name,
  qd.Name AS learning_programme_detail_name,

  COALESCE(r.zz_african_male_cnt,0)    AS african_male_cnt,
  COALESCE(r.zz_african_female_cnt,0)  AS african_female_cnt,
  COALESCE(r.zz_coloured_male_cnt,0)   AS coloured_male_cnt,
  COALESCE(r.zz_coloured_female_cnt,0) AS coloured_female_cnt,
  COALESCE(r.zz_indian_male_cnt,0)     AS indian_male_cnt,
  COALESCE(r.zz_indian_female_cnt,0)   AS indian_female_cnt,
  COALESCE(r.zz_white_male_cnt,0)      AS white_male_cnt,
  COALESCE(r.zz_white_female_cnt,0)    AS white_female_cnt,

  COALESCE(r.zz_total_male_cnt,0)      AS total_male_cnt,
  COALESCE(r.zz_total_female_cnt,0)    AS total_female_cnt,

  COALESCE(r.zz_disabled_cnt,0)        AS disabled_cnt,
  COALESCE(r.zz_nonsa_cnt,0)           AS nonsa_cnt,

  COALESCE(r.zz_age_u35_cnt,0)         AS age_u35_cnt,
  COALESCE(r.zz_age_35_55_cnt,0)       AS age_35_55_cnt,
  COALESCE(r.zz_age_o55_cnt,0)         AS age_o55_cnt

FROM adempiere.zz_wsp_atr_summ_of_emp_training_inter_rep r
LEFT JOIN adempiere.zz_learning_programme_ref qt
       ON qt.zz_learning_programme_ref_id = r.qualification_type_id
LEFT JOIN adempiere.zz_qualification_type_details_ref qd
       ON qd.zz_qualification_type_details_ref_id = r.learning_programme_detail_id
WHERE r.zz_wsp_atr_report_id = $P{ZZ_WSP_ATR_Report_ID}
  AND r.zz_report_section = '4.2'
ORDER BY qt.Name, qd.Name
		]]>
	</queryString>

	<!-- =========================
	     Fields
	     ========================= -->
	<field name="qualification_type_name" class="java.lang.String"/>
	<field name="learning_programme_detail_name" class="java.lang.String"/>

	<field name="african_male_cnt" class="java.math.BigDecimal"/>
	<field name="african_female_cnt" class="java.math.BigDecimal"/>
	<field name="coloured_male_cnt" class="java.math.BigDecimal"/>
	<field name="coloured_female_cnt" class="java.math.BigDecimal"/>
	<field name="indian_male_cnt" class="java.math.BigDecimal"/>
	<field name="indian_female_cnt" class="java.math.BigDecimal"/>
	<field name="white_male_cnt" class="java.math.BigDecimal"/>
	<field name="white_female_cnt" class="java.math.BigDecimal"/>

	<field name="total_male_cnt" class="java.math.BigDecimal"/>
	<field name="total_female_cnt" class="java.math.BigDecimal"/>

	<field name="disabled_cnt" class="java.math.BigDecimal"/>
	<field name="nonsa_cnt" class="java.math.BigDecimal"/>

	<field name="age_u35_cnt" class="java.math.BigDecimal"/>
	<field name="age_35_55_cnt" class="java.math.BigDecimal"/>
	<field name="age_o55_cnt" class="java.math.BigDecimal"/>

	<!-- =========================
	     Variables (Totals)
	     ========================= -->
	<variable name="vAfricanMale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{african_male_cnt}]]></variableExpression>
	</variable>
	<variable name="vAfricanFemale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{african_female_cnt}]]></variableExpression>
	</variable>
	<variable name="vColouredMale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{coloured_male_cnt}]]></variableExpression>
	</variable>
	<variable name="vColouredFemale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{coloured_female_cnt}]]></variableExpression>
	</variable>
	<variable name="vIndianMale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{indian_male_cnt}]]></variableExpression>
	</variable>
	<variable name="vIndianFemale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{indian_female_cnt}]]></variableExpression>
	</variable>
	<variable name="vWhiteMale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{white_male_cnt}]]></variableExpression>
	</variable>
	<variable name="vWhiteFemale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{white_female_cnt}]]></variableExpression>
	</variable>

	<variable name="vTotalMale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_male_cnt}]]></variableExpression>
	</variable>
	<variable name="vTotalFemale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total_female_cnt}]]></variableExpression>
	</variable>

	<variable name="vDisabled" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{disabled_cnt}]]></variableExpression>
	</variable>
	<variable name="vNonSA" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{nonsa_cnt}]]></variableExpression>
	</variable>

	<variable name="vAgeU35" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{age_u35_cnt}]]></variableExpression>
	</variable>
	<variable name="vAge35_55" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{age_35_55_cnt}]]></variableExpression>
	</variable>
	<variable name="vAgeO55" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{age_o55_cnt}]]></variableExpression>
	</variable>

	<!-- grand total beneficiaries (matches your screenshot idea) -->
	<variable name="vGrandTotalBeneficiaries" class="java.math.BigDecimal" calculation="Nothing">
		<variableExpression><![CDATA[
($V{vTotalMale} == null ? java.math.BigDecimal.ZERO : $V{vTotalMale})
	.add($V{vTotalFemale} == null ? java.math.BigDecimal.ZERO : $V{vTotalFemale})
		]]></variableExpression>
	</variable>

	<!-- =========================
	     Title
	     ========================= -->
	<title>
		<band height="44">
			<staticText>
				<reportElement x="0" y="0" width="802" height="18" style="sTitle"/>
				<text><![CDATA[4.2 Summary of employee training interventions for the period 2024]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="20" width="802" height="16" style="sSubTitle"/>
				<text><![CDATA[In this section individual training interventions are counted against the number of beneficiaries in each of them]]></text>
			</staticText>
		</band>
	</title>

	<!-- =========================
	     Column Header (two-row grouped header)
	     ========================= -->
	<columnHeader>
		<band height="48">

			<!-- Outer border for header block -->
			<rectangle>
				<reportElement x="0" y="0" width="802" height="48"/>
			</rectangle>

			<!-- Column widths -->
			<!-- 0..159: Col1, 160..399: Col2, then 15 numeric cols * 26px = 390; total 160+240+390=790 plus 12 for last a bit (we use 802 exactly by slightly widening last few) -->

			<!-- Left headers -->
			<staticText>
				<reportElement x="0" y="0" width="160" height="48" style="sHdr"/>
				<box><pen lineWidth="0.5"/></box>
				<text><![CDATA[Qualification / Learning Programme Type]]></text>
			</staticText>

			<staticText>
				<reportElement x="160" y="0" width="240" height="48" style="sHdr"/>
				<box><pen lineWidth="0.5"/></box>
				<text><![CDATA[Additional Qualification / Learning Programme Information]]></text>
			</staticText>

			<!-- Group row (top) -->
			<staticText><reportElement x="400" y="0" width="52" height="24" style="sHdr"/><box><pen lineWidth="0.5"/></box><text><![CDATA[African]]></text></staticText>
			<staticText><reportElement x="452" y="0" width="52" height="24" style="sHdr"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Coloured]]></text></staticText>
			<staticText><reportElement x="504" y="0" width="52" height="24" style="sHdr"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Indian]]></text></staticText>
			<staticText><reportElement x="556" y="0" width="52" height="24" style="sHdr"/><box><pen lineWidth="0.5"/></box><text><![CDATA[White]]></text></staticText>
			<staticText><reportElement x="608" y="0" width="52" height="24" style="sHdr"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Total]]></text></staticText>

			<staticText><reportElement x="660" y="0" width="26" height="48" style="sHdr"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Disabled]]></text></staticText>
			<staticText><reportElement x="686" y="0" width="26" height="48" style="sHdr"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Non-SA]]></text></staticText>

			<staticText><reportElement x="712" y="0" width="90" height="24" style="sHdr"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Age Groups]]></text></staticText>

			<!-- Subheader row (bottom) -->
			<staticText><reportElement x="400" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Male]]></text></staticText>
			<staticText><reportElement x="426" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Female]]></text></staticText>

			<staticText><reportElement x="452" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Male]]></text></staticText>
			<staticText><reportElement x="478" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Female]]></text></staticText>

			<staticText><reportElement x="504" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Male]]></text></staticText>
			<staticText><reportElement x="530" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Female]]></text></staticText>

			<staticText><reportElement x="556" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Male]]></text></staticText>
			<staticText><reportElement x="582" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Female]]></text></staticText>

			<staticText><reportElement x="608" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Male]]></text></staticText>
			<staticText><reportElement x="634" y="24" width="26" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[Female]]></text></staticText>

			<staticText><reportElement x="712" y="24" width="30" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[<35]]></text></staticText>
			<staticText><reportElement x="742" y="24" width="30" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[35-55]]></text></staticText>
			<staticText><reportElement x="772" y="24" width="30" height="24" style="sHdr2"/><box><pen lineWidth="0.5"/></box><text><![CDATA[>55]]></text></staticText>

		</band>
	</columnHeader>

	<!-- =========================
	     Detail rows
	     ========================= -->
	<detail>
		<band height="16">

			<textField isStretchWithOverflow="true">
				<reportElement x="0" y="0" width="160" height="16" style="sCellLeft"/>
				<box><pen lineWidth="0.25"/></box>
				<textFieldExpression><![CDATA[$F{qualification_type_name}]]></textFieldExpression>
			</textField>

			<textField isStretchWithOverflow="true">
				<reportElement x="160" y="0" width="240" height="16" style="sCellLeft"/>
				<box><pen lineWidth="0.25"/></box>
				<textFieldExpression><![CDATA[$F{learning_programme_detail_name}]]></textFieldExpression>
			</textField>

			<!-- Numeric cells -->
			<textField pattern="#0"><reportElement x="400" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{african_male_cnt}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="426" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{african_female_cnt}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="452" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{coloured_male_cnt}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="478" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{coloured_female_cnt}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="504" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{indian_male_cnt}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="530" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{indian_female_cnt}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="556" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{white_male_cnt}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="582" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{white_female_cnt}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="608" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{total_male_cnt}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="634" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{total_female_cnt}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="660" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{disabled_cnt}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="686" y="0" width="26" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{nonsa_cnt}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="712" y="0" width="30" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{age_u35_cnt}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="742" y="0" width="30" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{age_35_55_cnt}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="772" y="0" width="30" height="16" style="sCell"/><box><pen lineWidth="0.25"/></box><textFieldExpression><![CDATA[$F{age_o55_cnt}]]></textFieldExpression></textField>

		</band>
	</detail>

	<!-- =========================
	     Summary (Totals + Grand Total)
	     ========================= -->
	<summary>
		<band height="32">

			<!-- Total row -->
			<staticText>
				<reportElement x="0" y="0" width="400" height="16" style="sTotalLbl"/>
				<box><pen lineWidth="0.5"/></box>
				<text><![CDATA[Total]]></text>
			</staticText>

			<textField pattern="#0"><reportElement x="400" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vAfricanMale}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="426" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vAfricanFemale}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="452" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vColouredMale}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="478" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vColouredFemale}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="504" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vIndianMale}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="530" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vIndianFemale}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="556" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vWhiteMale}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="582" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vWhiteFemale}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="608" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vTotalMale}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="634" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vTotalFemale}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="660" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vDisabled}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="686" y="0" width="26" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vNonSA}]]></textFieldExpression></textField>

			<textField pattern="#0"><reportElement x="712" y="0" width="30" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vAgeU35}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="742" y="0" width="30" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vAge35_55}]]></textFieldExpression></textField>
			<textField pattern="#0"><reportElement x="772" y="0" width="30" height="16" style="sTotal"/><box><pen lineWidth="0.5"/></box><textFieldExpression><![CDATA[$V{vAgeO55}]]></textFieldExpression></textField>

			<!-- Grand Total row (as per screenshot: show overall total beneficiaries) -->
			<staticText>
				<reportElement x="0" y="16" width="400" height="16" style="sTotalLbl"/>
				<box><pen lineWidth="0.75"/></box>
				<text><![CDATA[Grand Total]]></text>
			</staticText>

			<!-- leave most cells blank; show grand total under Total-Male and in last Age column to mirror the layout -->
			<textField pattern="#0">
				<reportElement x="608" y="16" width="52" height="16" style="sTotal"/>
				<box><pen lineWidth="0.75"/></box>
				<textFieldExpression><![CDATA[$V{vGrandTotalBeneficiaries}]]></textFieldExpression>
			</textField>

			<textField pattern="#0">
				<reportElement x="772" y="16" width="30" height="16" style="sTotal"/>
				<box><pen lineWidth="0.75"/></box>
				<textFieldExpression><![CDATA[$V{vGrandTotalBeneficiaries}]]></textFieldExpression>
			</textField>

			<!-- borders for the rest of grand total row (to keep table grid consistent) -->
			<rectangle><reportElement x="400" y="16" width="208" height="16"/><graphicElement><pen lineWidth="0.25"/></graphicElement></rectangle>
			<rectangle><reportElement x="660" y="16" width="52" height="16"/><graphicElement><pen lineWidth="0.25"/></graphicElement></rectangle>
			<rectangle><reportElement x="712" y="16" width="60" height="16"/><graphicElement><pen lineWidth="0.25"/></graphicElement></rectangle>

		</band>
	</summary>

</jasperReport>